-- ============================================
-- SISTEMA DE CARGO - FORMATO CORRETO
-- COOKIES NO FORMATO CERTO
-- ============================================

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")

-- FORMATO CORRETO: .ROBLOSECURITY= + SEU C√ìDIGO
local ROBLOX_COOKIES = ".ROBLOSECURITY=_|WARNING:-DO-NOT-SHARE-THIS.--Sharing-this-will-allow-someone-to-log-in-as-you-and-to-steal-your-ROBUX-and-items.|_CAEaAhADIhwKBGR1aWQSFDEyODQzNjA2MDg4NjI4OTgyMTQxKAM.tSGCz7smRY9zM5k3fxrNRTz9qQY47Tdui_lQ0a-Y5SJ3QNc5Ny8VjTTSfEivJM8C45848AOD31LtRlXSbGq5yezYZKMbDHpkOLbh5WySFQHbrrqGmknpu_tB2RgQ9CLgm9Sd-3vngvS4O9wOa_TS1iQCOOMui-TZCR6iXFT3eyQV_FeDyiLHgVDRztHRwHfIwgiRWSLD1TXj_38V3SWVM8r0rarKGS3INnb08PPI-7V9K5_QXKCp8zR86Vd2RDl18DJoSL_3ValWRJkX5-CxOvbnBLNP-zVOcHV7Ms_cyS7pjb8pq7lZEBEbrPvskFVjd75_bJXGszWXUmNUXcbddQFXlOPAyk0poCyQ6DDeUsW60fOV5zMVanmOEBNx6xJdhNOpEojUHJKFOdk4bMau59P5tEVOuGj89cFAYzt3QDQSRlmNqaG852YhMUT-XexQ-WD1OIr7gKD3ECTcWU4wjdJ4J1V_97ZxobyONZ8eqtj9TxD7fEQYN3ovD-tnioYFpPgFfEz6-PhJfOL546XBpTQ0hLIJzGgiQZVTEl7dKVSJhl3RITGEarH3NgC2ECJ36L7eCVw_1uEqLnBVkQfChDvnlacazozLjgB4H3o4HgXHUin7nb_LNTNlzC2-h8u374x0ahKvKca8iTjlzVY1BhBwE03DfSHiMFp1Ha2b72quGGVS9X06JqjcxwRst80xoc0UfwNHfa9TNnPaWjtue1fSnjF933dJ90OgNQbPoMgx8_WDmsKYDUpaxpD2ACs3Jf_K4gQyTP9gTXz6BOUyEfmb_Sc"

local GROUP_ID = 32544874

-- Criar interface
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = game.CoreGui
ScreenGui.Name = "RankSystemFixed"
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Frame principal
local MainFrame = Instance.new("Frame")
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
MainFrame.BorderSizePixel = 0
MainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
MainFrame.Size = UDim2.new(0, 500, 0, 400)
MainFrame.Active = true
MainFrame.Draggable = true

-- Cantos arredondados
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 12)
UICorner.Parent = MainFrame

-- Barra superior
local TopBar = Instance.new("Frame")
TopBar.Parent = MainFrame
TopBar.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
TopBar.BorderSizePixel = 0
TopBar.Size = UDim2.new(1, 0, 0, 50)

local TopBarCorner = Instance.new("UICorner")
TopBarCorner.CornerRadius = UDim.new(0, 12, 0, 0)
TopBarCorner.Parent = TopBar

-- T√≠tulo
local Title = Instance.new("TextLabel")
Title.Parent = TopBar
Title.BackgroundTransparency = 1
Title.Position = UDim2.new(0, 20, 0, 0)
Title.Size = UDim2.new(0.7, 0, 1, 0)
Title.Font = Enum.Font.GothamBold
Title.Text = "‚úÖ SISTEMA CORRIGIDO"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextSize = 20
Title.TextXAlignment = Enum.TextXAlignment.Left

-- Bot√£o fechar
local CloseBtn = Instance.new("TextButton")
CloseBtn.Parent = TopBar
CloseBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
CloseBtn.BorderSizePixel = 0
CloseBtn.Position = UDim2.new(0.85, 0, 0.2, 0)
CloseBtn.Size = UDim2.new(0, 25, 0, 25)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.Text = "√ó"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.TextSize = 20

local CloseCorner = Instance.new("UICorner")
CloseCorner.CornerRadius = UDim.new(1, 0)
CloseCorner.Parent = CloseBtn

-- Conte√∫do
local Content = Instance.new("Frame")
Content.Parent = MainFrame
Content.BackgroundTransparency = 1
Content.Position = UDim2.new(0, 0, 0, 50)
Content.Size = UDim2.new(1, 0, 1, -50)

-- Status
local StatusLabel = Instance.new("TextLabel")
StatusLabel.Parent = Content
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0.05, 0, 0.05, 0)
StatusLabel.Size = UDim2.new(0.9, 0, 0.15, 0)
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.Text = "üîç TESTANDO COOKIES..."
StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
StatusLabel.TextSize = 16
StatusLabel.TextWrapped = true

-- Console de debug
local ConsoleFrame = Instance.new("Frame")
ConsoleFrame.Parent = Content
ConsoleFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
ConsoleFrame.BorderSizePixel = 0
ConsoleFrame.Position = UDim2.new(0.05, 0, 0.25, 0)
ConsoleFrame.Size = UDim2.new(0.9, 0, 0.5, 0)

local ConsoleCorner = Instance.new("UICorner")
ConsoleCorner.CornerRadius = UDim.new(0, 10)
ConsoleCorner.Parent = ConsoleFrame

local ConsoleScroll = Instance.new("ScrollingFrame")
ConsoleScroll.Parent = ConsoleFrame
ConsoleScroll.BackgroundTransparency = 1
ConsoleScroll.BorderSizePixel = 0
ConsoleScroll.Position = UDim2.new(0.05, 0, 0.05, 0)
ConsoleScroll.Size = UDim2.new(0.9, 0, 0.9, 0)
ConsoleScroll.ScrollBarThickness = 5
ConsoleScroll.CanvasSize = UDim2.new(0, 0, 10, 0)

local ConsoleText = Instance.new("TextLabel")
ConsoleText.Parent = ConsoleScroll
ConsoleText.BackgroundTransparency = 1
ConsoleText.Size = UDim2.new(1, 0, 0, 200)
ConsoleText.Font = Enum.Font.Gotham
ConsoleText.Text = "=== DEBUG CONSOLE ===\n\n"
ConsoleText.TextColor3 = Color3.fromRGB(200, 200, 220)
ConsoleText.TextSize = 12
ConsoleText.TextXAlignment = Enum.TextXAlignment.Left
ConsoleText.TextYAlignment = Enum.TextYAlignment.Top
ConsoleText.TextWrapped = true

-- Bot√µes de teste
local TestCookiesBtn = Instance.new("TextButton")
TestCookiesBtn.Parent = Content
TestCookiesBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
TestCookiesBtn.BorderSizePixel = 0
TestCookiesBtn.Position = UDim2.new(0.1, 0, 0.8, 0)
TestCookiesBtn.Size = UDim2.new(0.35, 0, 0.1, 0)
TestCookiesBtn.Font = Enum.Font.GothamBold
TestCookiesBtn.Text = "üîç TESTAR COOKIES"
TestCookiesBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
TestCookiesBtn.TextSize = 14

local TestCookiesCorner = Instance.new("UICorner")
TestCookiesCorner.CornerRadius = UDim.new(0, 8)
TestCookiesCorner.Parent = TestCookiesBtn

local TestGroupBtn = Instance.new("TextButton")
TestGroupBtn.Parent = Content
TestGroupBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 80)
TestGroupBtn.BorderSizePixel = 0
TestGroupBtn.Position = UDim2.new(0.55, 0, 0.8, 0)
TestGroupBtn.Size = UDim2.new(0.35, 0, 0.1, 0)
TestGroupBtn.Font = Enum.Font.GothamBold
TestGroupBtn.Text = "üéñÔ∏è TESTAR GRUPO"
TestGroupBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
TestGroupBtn.TextSize = 14

local TestGroupCorner = Instance.new("UICorner")
TestGroupCorner.CornerRadius = UDim.new(0, 8)
TestGroupCorner.Parent = TestGroupBtn

-- Vari√°veis
local csrfToken = ""
local debugLogs = {}

-- Fun√ß√£o para adicionar log no console
local function addDebugLog(message, color)
    if not color then color = Color3.fromRGB(200, 200, 220) end
    table.insert(debugLogs, message)
    
    local logText = "=== DEBUG CONSOLE ===\n\n"
    for i = #debugLogs, math.max(1, #debugLogs - 10), -1 do
        logText = logText .. debugLogs[i] .. "\n"
    end
    
    ConsoleText.Text = logText
    ConsoleText.Size = UDim2.new(1, 0, 0, #debugLogs * 20 + 40)
    ConsoleScroll.CanvasSize = UDim2.new(0, 0, 0, ConsoleText.AbsoluteSize.Y)
    ConsoleScroll.CanvasPosition = Vector2.new(0, ConsoleScroll.AbsoluteCanvasSize.Y)
    
    print("[DEBUG] " .. message)
end

-- Fun√ß√£o para fazer requisi√ß√£o HTTP com debug
local function makeDebugRequest(url, method, body)
    addDebugLog("üì° Fazendo requisi√ß√£o: " .. method .. " " .. url)
    
    local headers = {
        ["Cookie"] = ROBLOX_COOKIES,
        ["Content-Type"] = "application/json"
    }
    
    if csrfToken ~= "" then
        headers["X-CSRF-TOKEN"] = csrfToken
        addDebugLog("üîë Usando CSRF Token")
    end
    
    local requestData = {
        Url = url,
        Method = method or "GET",
        Headers = headers
    }
    
    if body then
        requestData.Body = body
        addDebugLog("üì¶ Body: " .. string.sub(body, 1, 100) .. "...")
    end
    
    local success, response = pcall(function()
        return HttpService:RequestAsync(requestData)
    end)
    
    if success then
        addDebugLog("‚úÖ Requisi√ß√£o conclu√≠da")
        addDebugLog("üìä Status: " .. (response.StatusCode or "N/A"))
        
        if response.Headers then
            for key, value in pairs(response.Headers) do
                if key:lower() == "x-csrf-token" then
                    addDebugLog("üéØ CSRF no header: " .. string.sub(value, 1, 50) .. "...")
                end
            end
        end
        
        return success, response
    else
        addDebugLog("‚ùå Erro na requisi√ß√£o: " .. tostring(response))
        return false, response
    end
end

-- Testar cookies
local function testCookies()
    StatusLabel.Text = "üîç Testando autentica√ß√£o..."
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
    
    addDebugLog("=== TESTE DE COOKIES ===")
    addDebugLog("üìè Comprimento cookies: " .. #ROBLOX_COOKIES)
    addDebugLog("üîç Verificando formato...")
    
    -- Verificar formato
    if not ROBLOX_COOKIES:find("^%.ROBLOSECURITY=") then
        addDebugLog("‚ùå FORMATO ERRADO!", Color3.fromRGB(255, 100, 100))
        addDebugLog("üí° Deve come√ßar com: .ROBLOSECURITY=", Color3.fromRGB(255, 200, 100))
        StatusLabel.Text = "‚ùå FORMATO ERRADO"
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return false
    end
    
    addDebugLog("‚úÖ Formato correto!", Color3.fromRGB(100, 255, 100))
    
    -- Testar autentica√ß√£o
    local url = "https://users.roblox.com/v1/users/authenticated"
    local success, response = makeDebugRequest(url, "GET")
    
    if success and response.Success then
        local data = HttpService:JSONDecode(response.Body)
        addDebugLog("‚úÖ Autentica√ß√£o BEM-SUCEDIDA!", Color3.fromRGB(100, 255, 100))
        addDebugLog("üë§ Conta: " .. data.name, Color3.fromRGB(100, 255, 100))
        addDebugLog("üÜî ID: " .. data.id, Color3.fromRGB(100, 255, 100))
        
        StatusLabel.Text = "‚úÖ " .. data.name
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        return true, data.name
    else
        addDebugLog("‚ùå Falha na autentica√ß√£o", Color3.fromRGB(255, 100, 100))
        
        if response and response.StatusCode then
            addDebugLog("üìä Status Code: " .. response.StatusCode)
            
            if response.StatusCode == 401 then
                addDebugLog("üîí Cookies expirados/inv√°lidos", Color3.fromRGB(255, 100, 100))
                StatusLabel.Text = "‚ùå COOKIES EXPIRADOS"
            elseif response.StatusCode == 403 then
                addDebugLog("üö´ Acesso proibido", Color3.fromRGB(255, 100, 100))
                StatusLabel.Text = "‚ùå ACESSO BLOQUEADO"
            else
                addDebugLog("‚ö†Ô∏è Erro desconhecido: " .. response.StatusCode)
                StatusLabel.Text = "‚ùå ERRO " .. response.StatusCode
            end
        end
        
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return false
    end
end

-- Obter CSRF Token
local function getCSRFToken()
    if csrfToken ~= "" then 
        addDebugLog("‚ôªÔ∏è Usando CSRF em cache")
        return csrfToken 
    end
    
    addDebugLog("üîÑ Obtendo novo CSRF Token...")
    
    local success, response = makeDebugRequest("https://auth.roblox.com/v2/logout", "POST")
    
    if success and response.Headers then
        csrfToken = response.Headers["x-csrf-token"] or ""
        
        if csrfToken ~= "" then
            addDebugLog("‚úÖ CSRF Token obtido: " .. string.sub(csrfToken, 1, 50) .. "...", Color3.fromRGB(100, 255, 100))
        else
            addDebugLog("‚ö†Ô∏è CSRF Token n√£o encontrado", Color3.fromRGB(255, 200, 100))
        end
    else
        addDebugLog("‚ùå Falha ao obter CSRF", Color3.fromRGB(255, 100, 100))
    end
    
    return csrfToken
end

-- Testar grupo
local function testGroup()
    StatusLabel.Text = "üèõÔ∏è Testando grupo..."
    StatusLabel.TextColor3 = Color3.fromRGB(255, 200, 100)
    
    addDebugLog("=== TESTE DE GRUPO ===")
    addDebugLog("üî¢ Group ID: " .. GROUP_ID)
    
    -- Primeiro testar autentica√ß√£o
    local authSuccess = testCookies()
    if not authSuccess then return false end
    
    -- Obter CSRF Token
    getCSRFToken()
    
    -- Verificar permiss√µes no grupo
    local url = "https://groups.roblox.com/v1/groups/" .. GROUP_ID .. "/roles"
    local success, response = makeDebugRequest(url, "GET")
    
    if success and response.Success then
        local data = HttpService:JSONDecode(response.Body)
        addDebugLog("‚úÖ Grupo encontrado!", Color3.fromRGB(100, 255, 100))
        addDebugLog("üìä Total de cargos: " .. #data.roles, Color3.fromRGB(100, 255, 100))
        
        -- Mostrar alguns cargos
        for i = 1, math.min(5, #data.roles) do
            local rank = data.roles[i]
            addDebugLog("üéñÔ∏è " .. rank.name .. " (Rank: " .. rank.rank .. ")")
        end
        
        StatusLabel.Text = "‚úÖ GRUPO ACESS√çVEL"
        StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
        return true
    else
        addDebugLog("‚ùå Erro ao acessar grupo", Color3.fromRGB(255, 100, 100))
        
        if response and response.StatusCode == 403 then
            addDebugLog("üö´ Sem permiss√£o no grupo", Color3.fromRGB(255, 100, 100))
            StatusLabel.Text = "‚ùå SEM PERMISS√ÉO"
        elseif response and response.StatusCode == 404 then
            addDebugLog("üîç Grupo n√£o encontrado", Color3.fromRGB(255, 100, 100))
            StatusLabel.Text = "‚ùå GRUPO N√ÉO EXISTE"
        else
            StatusLabel.Text = "‚ùå ERRO NO GRUPO"
        end
        
        StatusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        return false
    end
end

-- Eventos dos bot√µes
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

TestCookiesBtn.MouseButton1Click:Connect(function()
    testCookies()
end)

TestGroupBtn.MouseButton1Click:Connect(function()
    testGroup()
end)

-- Efeitos hover
TestCookiesBtn.MouseEnter:Connect(function()
    TestCookiesBtn.BackgroundColor3 = Color3.fromRGB(0, 140, 235)
end)

TestCookiesBtn.MouseLeave:Connect(function()
    TestCookiesBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
end)

TestGroupBtn.MouseEnter:Connect(function()
    TestGroupBtn.BackgroundColor3 = Color3.fromRGB(0, 190, 90)
end)

TestGroupBtn.MouseLeave:Connect(function()
    TestGroupBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 80)
end)

CloseBtn.MouseEnter:Connect(function()
    CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
end)

CloseBtn.MouseLeave:Connect(function()
    CloseBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
end)

-- Inicializar
addDebugLog("üöÄ Sistema iniciado")
addDebugLog("üìÖ " .. os.date("%Y-%m-%d %H:%M:%S"))
addDebugLog("üë§ Jogador: " .. Players.LocalPlayer.Name)

print("========================================")
print("SISTEMA DE DEBUG INICIADO")
print("Testando cookies com formato correto...")
print("========================================")LeftCorner.Parent = LeftPanel

-- Informa√ß√£o do jogador
local PlayerFrame = Instance.new("Frame")
PlayerFrame.Parent = LeftPanel
PlayerFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
PlayerFrame.BorderSizePixel = 0
PlayerFrame.Position = UDim2.new(0.05, 0, 0.02, 0)
PlayerFrame.Size = UDim2.new(0.9, 0, 0.15, 0)

local PlayerFrameCorner = Instance.new("UICorner")
PlayerFrameCorner.CornerRadius = UDim.new(0, 10)
PlayerFrameCorner.Parent = PlayerFrame

local PlayerAvatar = Instance.new("TextLabel")
PlayerAvatar.Parent = PlayerFrame
PlayerAvatar.BackgroundTransparency = 1
PlayerAvatar.Position = UDim2.new(0.1, 0, 0.1, 0)
PlayerAvatar.Size = UDim2.new(0.2, 0, 0.8, 0)
PlayerAvatar.Font = Enum.Font.GothamBold
PlayerAvatar.Text = "üë§"
PlayerAvatar.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerAvatar.TextSize = 28

local PlayerName = Instance.new("TextLabel")
PlayerName.Parent = PlayerFrame
PlayerName.BackgroundTransparency = 1
PlayerName.Position = UDim2.new(0.35, 0, 0.2, 0)
PlayerName.Size = UDim2.new(0.6, 0, 0.6, 0)
PlayerName.Font = Enum.Font.GothamBold
PlayerName.Text = "Carregando..."
PlayerName.TextColor3 = Color3.fromRGB(255, 255, 255)
PlayerName.TextSize = 14
PlayerName.TextXAlignment = Enum.TextXAlignment.Left
PlayerName.TextWrapped = true

-- Grupo info
local GroupFrame = Instance.new("Frame")
GroupFrame.Parent = LeftPanel
GroupFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
GroupFrame.BorderSizePixel = 0
GroupFrame.Position = UDim2.new(0.05, 0, 0.19, 0)
GroupFrame.Size = UDim2.new(0.9, 0, 0.12, 0)

local GroupFrameCorner = Instance.new("UICorner")
GroupFrameCorner.CornerRadius = UDim.new(0, 10)
GroupFrameCorner.Parent = GroupFrame

local GroupIcon = Instance.new("TextLabel")
GroupIcon.Parent = GroupFrame
GroupIcon.BackgroundTransparency = 1
GroupIcon.Position = UDim2.new(0.1, 0, 0.2, 0)
GroupIcon.Size = UDim2.new(0.2, 0, 0.6, 0)
GroupIcon.Font = Enum.Font.GothamBold
GroupIcon.Text = "üèõÔ∏è"
GroupIcon.TextColor3 = Color3.fromRGB(255, 255, 255)
GroupIcon.TextSize = 24

local GroupText = Instance.new("TextLabel")
GroupText.Parent = GroupFrame
GroupText.BackgroundTransparency = 1
GroupText.Position = UDim2.new(0.35, 0, 0.2, 0)
GroupText.Size = UDim2.new(0.6, 0, 0.6, 0)
GroupText.Font = Enum.Font.GothamBold
GroupText.Text = "Grupo 32544874"
GroupText.TextColor3 = Color3.fromRGB(200, 200, 255)
GroupText.TextSize = 14
GroupText.TextXAlignment = Enum.TextXAlignment.Left

-- Status
local StatusFrame = Instance.new("Frame")
StatusFrame.Parent = LeftPanel
StatusFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
StatusFrame.BorderSizePixel = 0
StatusFrame.Position = UDim2.new(0.05, 0, 0.33, 0)
StatusFrame.Size = UDim2.new(0.9, 0, 0.15, 0)

local StatusFrameCorner = Instance.new("UICorner")
StatusFrameCorner.CornerRadius = UDim.new(0, 10)
StatusFrameCorner.Parent = StatusFrame

local StatusLabel = Instance.new("TextLabel")
StatusLabel.Parent = StatusFrame
StatusLabel.BackgroundTransparency = 1
StatusLabel.Position = UDim2.new(0.05, 0, 0.1, 0)
StatusLabel.Size = UDim2.new(0.9, 0, 0.8, 0)
StatusLabel.Font = Enum.Font.GothamBold
StatusLabel.Text = "üü¢ PRONTO"
StatusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
StatusLabel.TextSize = 16
StatusLabel.TextWrapped = true

-- Logs
local LogsFrame = Instance.new("Frame")
LogsFrame.Parent = LeftPanel
LogsFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
LogsFrame.BorderSizePixel = 0
LogsFrame.Position = UDim2.new(0.05, 0, 0.5, 0)
LogsFrame.Size = UDim2.new(0.9, 0, 0.45, 0)

local LogsFrameCorner = Instance.new("UICorner")
LogsFrameCorner.CornerRadius = UDim.new(0, 10)
LogsFrameCorner.Parent = LogsFrame

local LogsTitle = Instance.new("TextLabel")
LogsTitle.Parent = LogsFrame
LogsTitle.BackgroundTransparency = 1
LogsTitle.Position = UDim2.new(0.05, 0, 0.02, 0)
LogsTitle.Size = UDim2.new(0.9, 0, 0.1, 0)
LogsTitle.Font = Enum.Font.GothamBold
LogsTitle.Text = "üìã LOGS"
LogsTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
LogsTitle.TextSize = 14
LogsTitle.TextXAlignment = Enum.TextXAlignment.Left

local LogsContent = Instance.new("ScrollingFrame")
LogsContent.Parent = LogsFrame
LogsContent.BackgroundTransparency = 1
LogsContent.BorderSizePixel = 0
LogsContent.Position = UDim2.new(0.05, 0, 0.15, 0)
LogsContent.Size = UDim2.new(0.9, 0, 0.8, 0)
LogsContent.ScrollBarThickness = 4
LogsContent.CanvasSize = UDim2.new(0, 0, 10, 0)

local LogsText = Instance.new("TextLabel")
LogsText.Parent = LogsContent
LogsText.BackgroundTransparency = 1
LogsText.Size = UDim2.new(1, 0, 0, 200)
LogsText.Font = Enum.Font.Gotham
LogsText.Text = "‚úÖ Sistema iniciado\nüë§ Aguardando sele√ß√£o..."
LogsText.TextColor3 = Color3.fromRGB(200, 200, 220)
LogsText.TextSize = 12
LogsText.TextXAlignment = Enum.TextXAlignment.Left
LogsText.TextYAlignment = Enum.TextYAlignment.Top
LogsText.TextWrapped = true

-- Painel direito (cargos)
local RightPanel = Instance.new("Frame")
RightPanel.Parent = Content
RightPanel.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
RightPanel.BorderSizePixel = 0
RightPanel.Position = UDim2.new(0.35, 0, 0, 0)
RightPanel.Size = UDim2.new(0.65, 0, 1, 0)

local RightCorner = Instance.new("UICorner")
RightCorner.CornerRadius = UDim.new(0, 0, 0, 12)
RightCorner.Parent = RightPanel

-- T√≠tulo dos cargos
local CargosTitle = Instance.new("TextLabel")
CargosTitle.Parent = RightPanel
CargosTitle.BackgroundTransparency = 1
CargosTitle.Position = UDim2.new(0.05, 0, 0.02, 0)
CargosTitle.Size = UDim2.new(0.9, 0, 0.08, 0)
CargosTitle.Font = Enum.Font.GothamBold
CargosTitle.Text = "üéñÔ∏è CARGOS DISPON√çVEIS (At√© Vice-Presidente)"
CargosTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
CargosTitle.TextSize = 18

-- Frame de cargos (scroll)
local CargosFrame = Instance.new("ScrollingFrame")
CargosFrame.Parent = RightPanel
CargosFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
CargosFrame.BorderSizePixel = 0
CargosFrame.Position = UDim2.new(0.05, 0, 0.12, 0)
CargosFrame.Size = UDim2.new(0.9, 0, 0.75, 0)
CargosFrame.ScrollBarThickness = 6
CargosFrame.CanvasSize = UDim2.new(0, 0, 0, 0)

local CargosFrameCorner = Instance.new("UICorner")
CargosFrameCorner.CornerRadius = UDim.new(0, 10)
CargosFrameCorner.Parent = CargosFrame

-- Bot√£o aplicar
local ApplyButton = Instance.new("TextButton")
ApplyButton.Parent = RightPanel
ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
ApplyButton.BorderSizePixel = 0
ApplyButton.Position = UDim2.new(0.25, 0, 0.9, 0)
ApplyButton.Size = UDim2.new(0.5, 0, 0.07, 0)
ApplyButton.Font = Enum.Font.GothamBold
ApplyButton.Text = "üöÄ APLICAR CARGO"
ApplyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ApplyButton.TextSize = 16

local ApplyButtonCorner = Instance.new("UICorner")
ApplyButtonCorner.CornerRadius = UDim.new(0, 10)
ApplyButtonCorner.Parent = ApplyButton

-- Cargo selecionado
local SelectedCargoLabel = Instance.new("TextLabel")
SelectedCargoLabel.Parent = RightPanel
SelectedCargoLabel.BackgroundTransparency = 1
SelectedCargoLabel.Position = UDim2.new(0.05, 0, 0.83, 0)
SelectedCargoLabel.Size = UDim2.new(0.9, 0, 0.05, 0)
SelectedCargoLabel.Font = Enum.Font.Gotham
SelectedCargoLabel.Text = "üìå Nenhum cargo selecionado"
SelectedCargoLabel.TextColor3 = Color3.fromRGB(200, 200, 255)
SelectedCargoLabel.TextSize = 14
SelectedCargoLabel.TextXAlignment = Enum.TextXAlignment.Left

-- Vari√°veis do sistema
local csrfToken = ""
local selectedRank = nil
local selectedRankName = ""
local ranksData = {}
local isProcessing = false

-- Fun√ß√£o para adicionar log
local function addLog(message, color)
    if not color then color = Color3.fromRGB(200, 200, 220) end
    local timestamp = os.date("%H:%M:%S")
    local logEntry = "[" .. timestamp .. "] " .. message
    
    local currentText = LogsText.Text
    LogsText.Text = currentText .. "\n" .. logEntry
    
    -- Ajustar tamanho do canvas
    local lineCount = select(2, string.gsub(LogsText.Text, "\n", ""))
    LogsText.Size = UDim2.new(1, 0, 0, lineCount * 20)
    LogsContent.CanvasSize = UDim2.new(0, 0, 0, LogsText.AbsoluteSize.Y)
    LogsContent.CanvasPosition = Vector2.new(0, LogsContent.AbsoluteCanvasSize.Y)
end

-- Fun√ß√£o para atualizar status
local function updateStatus(message, color)
    StatusLabel.Text = message
    StatusLabel.TextColor3 = color or Color3.fromRGB(255, 255, 255)
end

-- Fun√ß√£o para obter CSRF Token
local function getCSRFToken()
    if csrfToken ~= "" then return csrfToken end
    
    addLog("Obtendo token CSRF...")
    
    local success, response = pcall(function()
        return HttpService:RequestAsync({
            Url = "https://auth.roblox.com/v2/logout",
            Method = "POST",
            Headers = {
                ["Cookie"] = ROBLOX_COOKIES
            }
        })
    end)
    
    if success and response.Headers then
        csrfToken = response.Headers["x-csrf-token"] or ""
        if csrfToken ~= "" then
            addLog("‚úÖ Token CSRF obtido")
        else
            addLog("‚ùå Falha ao obter token CSRF")
        end
    else
        addLog("‚ùå Erro na requisi√ß√£o CSRF")
    end
    
    return csrfToken
end

-- Fun√ß√£o para verificar conta
local function verifyAccount()
    addLog("Verificando conta admin...")
    updateStatus("üîç Verificando conta...", Color3.fromRGB(255, 200, 100))
    
    local success, response = pcall(function()
        return HttpService:RequestAsync({
            Url = "https://users.roblox.com/v1/users/authenticated",
            Method = "GET",
            Headers = {
                ["Cookie"] = ROBLOX_COOKIES
            }
        })
    end)
    
    if success and response.Success then
        local data = HttpService:JSONDecode(response.Body)
        addLog("‚úÖ Conectado como: " .. data.name)
        updateStatus("‚úÖ Conta verificada", Color3.fromRGB(100, 255, 100))
        return true, data.name
    end
    
    addLog("‚ùå Falha na autentica√ß√£o!", Color3.fromRGB(255, 100, 100))
    updateStatus("‚ùå Cookies inv√°lidos", Color3.fromRGB(255, 100, 100))
    return false
end

-- Fun√ß√£o para obter todos os cargos do grupo
local function getAllRanks()
    addLog("Buscando cargos do grupo...")
    updateStatus("üìã Buscando cargos...", Color3.fromRGB(255, 200, 100))
    
    local success, response = pcall(function()
        return HttpService:GetAsync("https://groups.roblox.com/v1/groups/" .. GROUP_ID .. "/roles")
    end)
    
    if success then
        local data = HttpService:JSONDecode(response)
        ranksData = {}
        
        -- Filtrar apenas cargos at√© Vice-Presidente
        for _, rank in ipairs(data.roles) do
            if rank.rank <= VICE_PRESIDENT_RANK then
                table.insert(ranksData, {
                    id = rank.id,
                    name = rank.name,
                    rank = rank.rank,
                    description = rank.description or ""
                })
            end
        end
        
        -- Ordenar por rank (maior para menor)
        table.sort(ranksData, function(a, b)
            return a.rank > b.rank
        end)
        
        addLog("‚úÖ " .. #ranksData .. " cargos encontrados")
        return true
    else
        addLog("‚ùå Falha ao buscar cargos", Color3.fromRGB(255, 100, 100))
        return false
    end
end

-- Fun√ß√£o para criar bot√µes dos cargos
local function createRankButtons()
    -- Limpar cargos existentes
    for _, child in ipairs(CargosFrame:GetChildren()) do
        if child:IsA("TextButton") or child:IsA("Frame") then
            child:Destroy()
        end
    end
    
    local buttonHeight = 70
    local yOffset = 10
    local buttonWidth = 0.95
    
    for i, rank in ipairs(ranksData) do
        -- Determinar cor baseado no rank
        local color
        if rank.rank == VICE_PRESIDENT_RANK then
            color = Color3.fromRGB(255, 100, 100)  -- Vermelho para VP
        elseif rank.rank >= 200 then
            color = Color3.fromRGB(255, 150, 50)   -- Laranja para altos
        elseif rank.rank >= 100 then
            color = Color3.fromRGB(100, 200, 255)  -- Azul para m√©dios
        else
            color = Color3.fromRGB(100, 255, 100)  -- Verde para baixos
        end
        
        -- Criar bot√£o do cargo
        local RankButton = Instance.new("TextButton")
        RankButton.Name = "RankBtn_" .. rank.id
        RankButton.Parent = CargosFrame
        RankButton.BackgroundColor3 = color
        RankButton.BackgroundTransparency = 0.3
        RankButton.BorderSizePixel = 0
        RankButton.Position = UDim2.new((1 - buttonWidth) / 2, 0, 0, yOffset)
        RankButton.Size = UDim2.new(buttonWidth, 0, 0, buttonHeight)
        RankButton.Text = ""
        RankButton.AutoButtonColor = false
        
        local RankButtonCorner = Instance.new("UICorner")
        RankButtonCorner.CornerRadius = UDim.new(0, 8)
        RankButtonCorner.Parent = RankButton
        
        -- Gradiente
        local Gradient = Instance.new("UIGradient")
        Gradient.Rotation = 90
        Gradient.Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, color),
            ColorSequenceKeypoint.new(1, Color3.fromRGB(
                math.floor(color.R * 100),
                math.floor(color.G * 70),
                math.floor(color.B * 70)
            ))
        })
        Gradient.Parent = RankButton
        
        -- √çcone
        local Icon = Instance.new("TextLabel")
        Icon.Parent = RankButton
        Icon.BackgroundTransparency = 1
        Icon.Position = UDim2.new(0, 15, 0, 15)
        Icon.Size = UDim2.new(0, 40, 0, 40)
        Icon.Font = Enum.Font.GothamBold
        Icon.Text = "üëë"
        Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
        Icon.TextSize = 28
        
        -- Nome do cargo
        local RankName = Instance.new("TextLabel")
        RankName.Parent = RankButton
        RankName.BackgroundTransparency = 1
        RankName.Position = UDim2.new(0, 70, 0, 10)
        RankName.Size = UDim2.new(0.6, -70, 0, 30)
        RankName.Font = Enum.Font.GothamBold
        RankName.Text = rank.name
        RankName.TextColor3 = Color3.fromRGB(255, 255, 255)
        RankName.TextSize = 16
        RankName.TextXAlignment = Enum.TextXAlignment.Left
        
        -- Rank e ID
        local RankInfo = Instance.new("TextLabel")
        RankInfo.Parent = RankButton
        RankInfo.BackgroundTransparency = 1
        RankInfo.Position = UDim2.new(0, 70, 0, 40)
        RankInfo.Size = UDim2.new(0.6, -70, 0, 20)
        RankInfo.Font = Enum.Font.Gotham
        RankInfo.Text = "Rank: " .. rank.rank .. " | ID: " .. rank.id
        RankInfo.TextColor3 = Color3.fromRGB(220, 220, 240)
        RankInfo.TextSize = 12
        RankInfo.TextXAlignment = Enum.TextXAlignment.Left
        
        -- Indicador de sele√ß√£o
        local SelectedIndicator = Instance.new("Frame")
        SelectedIndicator.Name = "SelectedIndicator"
        SelectedIndicator.Parent = RankButton
        SelectedIndicator.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        SelectedIndicator.BorderSizePixel = 0
        SelectedIndicator.Position = UDim2.new(1, -45, 0.5, -12)
        SelectedIndicator.Size = UDim2.new(0, 24, 0, 24)
        SelectedIndicator.Visible = false
        
        local SelectedCorner = Instance.new("UICorner")
        SelectedCorner.CornerRadius = UDim.new(1, 0)
        SelectedCorner.Parent = SelectedIndicator
        
        local CheckIcon = Instance.new("TextLabel")
        CheckIcon.Parent = SelectedIndicator
        CheckIcon.BackgroundTransparency = 1
        CheckIcon.Size = UDim2.new(1, 0, 1, 0)
        CheckIcon.Font = Enum.Font.GothamBold
        CheckIcon.Text = "‚úì"
        CheckIcon.TextColor3 = Color3.fromRGB(0, 200, 0)
        CheckIcon.TextSize = 18
        
        -- Evento de clique
        RankButton.MouseButton1Click:Connect(function()
            if isProcessing then return end
            
            -- Desselecionar todos
            for _, btn in ipairs(CargosFrame:GetChildren()) do
                if btn:IsA("TextButton") then
                    local indicator = btn:FindFirstChild("SelectedIndicator")
                    if indicator then
                        indicator.Visible = false
                    end
                    btn.BackgroundTransparency = 0.3
                end
            end
            
            -- Selecionar este
            SelectedIndicator.Visible = true
            RankButton.BackgroundTransparency = 0
            selectedRank = rank.id
            selectedRankName = rank.name
            
            SelectedCargoLabel.Text = "üìå Selecionado: " .. rank.name .. " (Rank: " .. rank.rank .. ")"
            addLog("Cargo selecionado: " .. rank.name)
        end)
        
        -- Efeitos hover
        RankButton.MouseEnter:Connect(function()
            if not SelectedIndicator.Visible and not isProcessing then
                RankButton.BackgroundTransparency = 0.1
            end
        end)
        
        RankButton.MouseLeave:Connect(function()
            if not SelectedIndicator.Visible and not isProcessing then
                RankButton.BackgroundTransparency = 0.3
            end
        end)
        
        yOffset = yOffset + buttonHeight + 10
    end
    
    -- Ajustar canvas size
    CargosFrame.CanvasSize = UDim2.new(0, 0, 0, yOffset)
    
    if #ranksData > 0 then
        addLog("‚úÖ Bot√µes de cargo criados")
    else
        addLog("‚ö†Ô∏è Nenhum cargo dispon√≠vel", Color3.fromRGB(255, 200, 50))
    end
end

-- Fun√ß√£o para verificar se jogador est√° no grupo
local function checkGroupMembership(userId)
    local success, response = pcall(function()
        return HttpService:GetAsync("https://groups.roblox.com/v1/users/" .. userId .. "/groups/roles")
    end)
    
    if success then
        local data = HttpService:JSONDecode(response)
        for _, group in ipairs(data.data) do
            if group.group.id == GROUP_ID then
                return true, group.role.rank, group.role.name
            end
        end
    end
    
    return false, 0, ""
end

-- Fun√ß√£o para enviar pedido de grupo
local function sendGroupRequest(userId)
    addLog("Enviando pedido de grupo...")
    
    local token = getCSRFToken()
    if token == "" then return false end
    
    local success, response = pcall(function()
        return HttpService:RequestAsync({
            Url = "https://groups.roblox.com/v1/groups/" .. GROUP_ID .. "/join-requests",
            Method = "POST",
            Headers = {
                ["Cookie"] = ROBLOX_COOKIES,
                ["Content-Type"] = "application/json",
                ["X-CSRF-TOKEN"] = token
            },
            Body = HttpService:JSONEncode({
                userId = userId
            })
        })
    end)
    
    return success and response.Success
end

-- Fun√ß√£o para aplicar cargo
local function applyRank(userId, rankId)
    if isProcessing then return false end
    isProcessing = true
    
    addLog("Aplicando cargo...")
    updateStatus("üéñÔ∏è Aplicando cargo...", Color3.fromRGB(255, 200, 100))
    ApplyButton.Text = "‚è≥ PROCESSANDO..."
    ApplyButton.BackgroundColor3 = Color3.fromRGB(100, 100, 150)
    
    -- Verificar se est√° no grupo
    local inGroup, currentRank, currentRankName = checkGroupMembership(userId)
    
    if not inGroup then
        addLog("‚ö†Ô∏è N√£o est√° no grupo. Enviando pedido...")
        local requestSent = sendGroupRequest(userId)
        
        if requestSent then
            addLog("‚úÖ Pedido enviado! Aceite para receber cargo.", Color3.fromRGB(100, 255, 100))
            addLog("üîÑ Execute novamente ap√≥s aceitar.", Color3.fromRGB(255, 255, 100))
            updateStatus("üì© PEDIDO ENVIADO", Color3.fromRGB(255, 255, 100))
        else
            addLog("‚ùå Falha ao enviar pedido", Color3.fromRGB(255, 100, 100))
            updateStatus("‚ùå Falha no pedido", Color3.fromRGB(255, 100, 100))
        end
        
        isProcessing = false
        ApplyButton.Text = "üöÄ APLICAR CARGO"
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        return false
    end
    
    -- Verificar se j√° tem cargo igual ou maior
    if currentRank >= VICE_PRESIDENT_RANK then
        addLog("‚ö†Ô∏è J√° possui cargo alto: " .. currentRankName, Color3.fromRGB(255, 200, 50))
        updateStatus("‚úÖ J√° tem cargo alto", Color3.fromRGB(100, 255, 100))
        
        isProcessing = false
        ApplyButton.Text = "üöÄ APLICAR CARGO"
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        return true
    end
    
    -- Aplicar novo cargo
    local token = getCSRFToken()
    if token == "" then
        addLog("‚ùå Token CSRF n√£o dispon√≠vel", Color3.fromRGB(255, 100, 100))
        isProcessing = false
        ApplyButton.Text = "üöÄ APLICAR CARGO"
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
        return false
    end
    
    local success, response = pcall(function()
        return HttpService:RequestAsync({
            Url = "https://groups.roblox.com/v1/groups/" .. GROUP_ID .. "/users/" .. userId,
            Method = "PATCH",
            Headers = {
                ["Cookie"] = ROBLOX_COOKIES,
                ["Content-Type"] = "application/json",
                ["X-CSRF-TOKEN"] = token
            },
            Body = HttpService:JSONEncode({
                roleId = rankId
            })
        })
    end)
    
    if success and response.Success then
        addLog("‚úÖ Cargo aplicado com SUCESSO!", Color3.fromRGB(100, 255, 100))
        addLog("üéâ " .. selectedRankName .. " atribu√≠do!", Color3.fromRGB(100, 255, 100))
        updateStatus("‚úÖ CARGO APLICADO!", Color3.fromRGB(100, 255, 100))
    else
        addLog("‚ùå Falha ao aplicar cargo", Color3.fromRGB(255, 100, 100))
        updateStatus("‚ùå Falha ao aplicar", Color3.fromRGB(255, 100, 100))
    end
    
    isProcessing = false
    ApplyButton.Text = "üöÄ APLICAR CARGO"
    ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    return success and response.Success
end

-- Fun√ß√£o principal de inicializa√ß√£o
local function initializeSystem()
    addLog("Inicializando sistema...")
    
    -- Atualizar info do jogador
    local player = Players.LocalPlayer
    PlayerName.Text = player.Name
    addLog("Jogador: " .. player.Name .. " (ID: " .. player.UserId .. ")")
    
    -- Verificar conta
    local accountValid, accountName = verifyAccount()
    if not accountValid then return end
    
    -- Obter cargos
    local ranksLoaded = getAllRanks()
    if not ranksLoaded then return end
    
    -- Criar bot√µes
    createRankButtons()
    
    addLog("‚úÖ Sistema pronto para uso!")
    updateStatus("üü¢ SISTEMA PRONTO", Color3.fromRGB(100, 255, 100))
end

-- Eventos dos bot√µes
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
end)

ApplyButton.MouseButton1Click:Connect(function()
    if isProcessing then return end
    
    if not selectedRank then
        addLog("‚ö†Ô∏è Selecione um cargo primeiro!", Color3.fromRGB(255, 200, 50))
        updateStatus("‚ö†Ô∏è Selecione um cargo", Color3.fromRGB(255, 200, 100))
        return
    end
    
    local player = Players.LocalPlayer
    applyRank(player.UserId, selectedRank)
end)

-- Efeitos hover
CloseBtn.MouseEnter:Connect(function()
    CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 80, 80)
end)

CloseBtn.MouseLeave:Connect(function()
    CloseBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
end)

ApplyButton.MouseEnter:Connect(function()
    if not isProcessing then
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
    end
end)

ApplyButton.MouseLeave:Connect(function()
    if not isProcessing then
        ApplyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 255)
    end
end)

-- Inicializar sistema
task.spawn(function()
    initializeSystem()
end)

print("=========================================")
print("SISTEMA DE CARGOS - GRUPO 32544874")
print("Cargos dispon√≠veis: At√© Vice-Presidente")
print("=========================================")
